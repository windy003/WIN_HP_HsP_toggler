# 代理切换器

这是一个简单的 Windows 命令行工具，用于快速切换（打开或关闭）系统的 HTTP 和 HTTPS 代理环境变量。

## 功能

- **一键切换**：运行脚本可立即在预设的代理地址和无代理之间切换。
- **自动检测**：脚本会自动检测当前的环境变量状态来决定是设置还是清除代理。
- **即时生效**：通过调用 Windows API，更改会立即广播到系统中的所有应用程序，无需重启终端或注销。

## 如何使用

1. **配置代理地址**（可选）:
   - 如果你的代理地址不是 `http://127.0.0.1:33000`，请在 `proxy_toggler.py` 脚本中修改 `proxy_address` 变量的值。

2. **运行脚本**:
   - 直接在命令行中执行 `python proxy_toggler.py`。
   - 或者，为了更方便地使用，你可以使用 PyInstaller 将其打包成一个 `.exe` 可执行文件。运行 `pyinstaller --onefile proxy_toggler.py` 来创建。

## 工作原理

- **设置代理**：当脚本检测到当前没有设置代理时，它会使用 `setx` 命令将 `http_proxy` 和 `https_proxy` (以及它们的大写形式) 设置为指定的代理地址。
- **清除代理**：如果检测到已存在代理设置，脚本会使用 `reg delete` 命令从注册表中彻底删除这些环境变量。
- **通知系统**：在执行设置或清除操作后，脚本会调用 Windows API 的 `SendMessageTimeoutW` 函数来广播 `WM_SETTINGCHANGE` 消息。这会通知所有打开的应用程序（包括文件资源管理器和命令提示符）环境变量已发生变化，从而使更改即时生效。
